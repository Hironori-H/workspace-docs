# 修正指示書 - 作業前提条件ドキュメント統合版から分割版への更新

**作成日**: 2025年11月22日
**対象**: 作業前提条件ドキュメント（Worker用・Reviewer用）
**目的**: 統合版の最新内容を分割版に反映し、バージョン管理を一元化

---

## 📋 修正サマリー

統合版（Worker v2.7, Reviewer v1.5）の内容を分割版に反映し、以下を実現：

1. **統合版の最新内容を分割版に反映**
2. **バージョン管理の一元化**（VERSION.mdを作成）
3. **統合版ファイル名にバージョン番号を追記**

---

## 🎯 ユーザーの事前指示（最優先）

【重要】以下のユーザー指示を厳守してください：

1. **配置方針**: 分割内容に適したセクションに追記。適したセクションがない場合は新規ファイルを作成
2. **バージョン管理**: 各ファイルではなく、`DOCS/作業前提条件/` 直下の `VERSION.md` で一元管理
3. **統合版ファイル名**: バージョンが一目で分かるようにファイル名に追記

---

## 📊 差分分析結果

### Reviewer用ドキュメント

| 統合版 | 分割版 | 状態 |
|-------|--------|------|
| v1.5 (2025-11-19) | v1.2-v1.3 (2025-11-14~2025-11-17) | **更新必要** |

**主な追加内容**:
1. **v1.4追加**: ステップ0.6「修正指示書へのバックアップ手順の明記」（約110行）
2. **v1.5追加**: 「作業ログ・メモの記録」セクション（約200行）
3. **v1.3追加**: レビュー結果と修正指示書の分離ルール詳細（分割版には一部あり）

### Worker用ドキュメント

| 統合版 | 分割版 | 状態 |
|-------|--------|------|
| v2.7 (2025-11-19) | バージョン情報なし | **更新必要** |

**主な追加内容**:
1. **v2.7追加**: 「バックアップ管理規約」の詳細化（約130行）
2. **v2.6追加**: 「バッチファイル・スクリプト作成時の規約」の詳細（約150行）

---

## 🔧 修正内容

### Part 1: バージョン管理ファイルの作成

#### 1-1. VERSION.md を作成

**ファイルパス**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/VERSION.md`

**内容**:

```markdown
# 作業前提条件ドキュメント - バージョン情報

このドキュメントは、作業前提条件ドキュメント（統合版・分割版）のバージョン情報を一元管理します。

---

## 📌 現在のバージョン

### 統合版（単一ファイル）

| ドキュメント | バージョン | 最終更新日 | ファイル名 |
|------------|----------|-----------|-----------|
| **Worker用** | **v2.7** | 2025-11-19 | `作業前提条件_Worker_v2.7.md` |
| **Reviewer用** | **v1.5** | 2025-11-19 | `作業前提条件_Reviewer_v1.5.md` |

### 分割版（モジュール式）

| カテゴリ | 対応する統合版バージョン | 最終更新日 | 備考 |
|---------|---------------------|-----------|------|
| **Worker** | v2.7 | 2025-11-22 | 統合版v2.7の内容を反映 |
| **Reviewer** | v1.5 | 2025-11-22 | 統合版v1.5の内容を反映 |

---

## 📝 統合版 変更履歴

### Worker用（統合版）

#### v2.7 (2025-11-19)
- バックアップ管理規約を詳細化
  - 2段階バックアップ（レベル1: 修正前、レベル2: 検証済み）を定義
  - バックアップの命名規則を統一（作業指示書の要約を含める）
  - バックアップ取得手順を標準化
  - 保存期間の明確化（容量が許す限り無期限）
  - バックアップ対象・対象外を明記
  - 大容量ファイルの扱いを定義
  - 作業ログへの記録テンプレートを追加
  - バックアップ復元手順を追加

#### v2.6 (2025-11-14)
- バッチファイル・スクリプト作成時の規約を追加
  - 変数名・関数名・ラベル名は英数字のみ使用を義務化（日本語禁止）
  - スクリプトファイル名は英数字を強く推奨
  - 出力メッセージは英語を推奨（文字化け対策）
  - 日本語を含むパスの取り扱いルールを明記（必ずダブルクォート）
  - 文字エンコーディングの推奨設定を定義
  - スクリプト作成時のチェックリストを追加
  - よくある問題と解決策を追加
  - 正しいバッチファイルの構造の実例を追加

#### v2.5 (2025-11-14)
- デバッグ・トラブルシューティング中のファイル管理ルールを追加
  - 中間ファイルの命名規則を統一
  - デバッグワークフロー（4フェーズ）を定義
  - debug_files/ フォルダの活用方法を明記
  - 作業完了時のクリーンアップチェックリストを追加

#### v2.4 (2025-11-14)
- 指示の優先順位と矛盾時の対処ルールを追加
  - 5段階の指示優先順位を定義
  - 矛盾発見時の対処手順を明記
  - バージョン番号管理の特別ルールを追加

#### v2.3 (2025-11-13)
- ハルシネーション抑止ルールを強化
  - ファイル内容の正確な確認を義務化

#### v2.2 (2025-11-13)
- ハルシネーション抑止ルールを追加

#### v2.1 (2025-11-13)
- Claude Code 作業原則・行動指針を追加
  - 前提条件・目的の厳守ルールを追加

#### v2.0 (2025-11-13)
- 大幅な機能追加
  - 出力ファイル・生成ファイルの管理ルール追加
  - 作業ログ・メモの記録ルール追加
  - 環境変数・設定ファイルの管理ルール追加
  - 特殊ツール固有のルール追加

#### v1.2 (2025-11-13)
- バージョニングルール（マイナー/メジャーバージョン）を明確化

#### v1.1 (2025-11-13)
- 過去のファイルを編集する場合のルールを追加

#### v1.0 (2025-11-13)
- 初版作成

---

### Reviewer用（統合版）

#### v1.5 (2025-11-19)
- 作業ログ記録の必須化
  - 「作業ログ・メモの記録」セクションを新規追加
  - Reviewerも作業ログを記録することを義務化
  - WorkerとReviewerの作業を同じworklogファイルに記録するルールを明確化
  - Reviewer用の作業ログテンプレートを追加
  - 記録すべき作業内容を4カテゴリーに分類
  - 作業ログの更新タイミングを5段階で定義
  - 作業完了報告時のルール（worklog記録の明記）を追加

#### v1.4 (2025-11-19)
- バックアップ手順の必須化
  - 「ステップ0.6: 修正指示書へのバックアップ手順の明記（必須）」を新規追加
  - 2段階バックアップシステム（Level 1: 修正前、Level 2: 検証済み）の導入
  - バックアップ命名規則の標準化（作業指示書要約を含む）
  - 修正指示書テンプレートにバックアップセクションを追加
  - バックアップ手順記載のチェックリスト（8項目）を追加
  - 大容量ファイル確認フローを明記
  - すべての修正指示書にバックアップ手順を含めることを義務化

#### v1.3 (2025-11-18)
- 直接コード修正の禁止を明記
  - 「Reviewerの最重要原則」セクションを新規追加
  - 直接コード修正の禁止を明示的に記載
  - 「修正を実施してください」と言われた場合の正しい対応手順を追加
  - レビュー結果と修正指示書の分離ルールを追加
  - ドキュメントのバージョニングルールを追加

#### v1.2 (2025-11-14)
- ユーザーの事前指示確認プロセスを追加
  - レビュープロセスに「ステップ0.5: ユーザーの事前指示の確認」を追加
  - 修正指示書作成前のユーザー指示確認手順を詳細化
  - バージョン番号変更時の確認プロトコルを明記

#### v1.1 (2025-11-14)
- Workspace全体把握機能を追加
  - レビュープロセスに「ステップ0: Workspace全体の把握」を追加

#### v1.0 (2025-11-13)
- 初版作成

---

## 🔄 分割版の更新履歴

### 2025-11-22: 統合版v2.7/v1.5の内容を反映

**Worker用分割版**:
- `02_ファイル管理.md`: バックアップ管理規約を詳細化（v2.7対応）
- `03_バッチファイル・スクリプト規約.md`: 既存の内容を維持（既にv2.6相当の内容あり）

**Reviewer用分割版**:
- `02_レビュープロセスとワークフロー.md`: バックアップ手順とドキュメント作成ルールを追加（v1.4, v1.5対応）
- `04_作業ログとドキュメント管理.md`: 新規作成（v1.5対応）

---

## 📚 ドキュメント構成

### 統合版（単一ファイル）
```
DOCS/
├── 作業前提条件_Worker_v2.7.md        # Worker用統合版
└── 作業前提条件_Reviewer_v1.5.md      # Reviewer用統合版
```

### 分割版（モジュール式）
```
DOCS/作業前提条件/
├── VERSION.md                          # バージョン管理（このファイル）
├── 利用ガイド.md                        # 使い分けガイド
├── Worker/
│   ├── 00_INDEX.md                     # インデックス
│   ├── 00_QUICK_REFERENCE.md           # クイックリファレンス
│   ├── 01_基本ルール.md
│   ├── 02_ファイル管理.md
│   ├── 03_バッチファイル・スクリプト規約.md
│   ├── 04_デバッグ・トラブルシューティング規約.md
│   ├── 05_指示の優先順位と矛盾時の対処.md
│   ├── 06_ハルシネーション抑止とベストプラクティス.md
│   └── 07_特殊ツール固有ルール.md
└── Reviewer/
    ├── 00_INDEX.md                     # インデックス
    ├── 00_QUICK_REFERENCE.md           # クイックリファレンス
    ├── 01_基本ルールとレビュー原則.md
    ├── 02_レビュープロセスとワークフロー.md
    ├── 03_チェックリストと評価基準.md
    └── 04_作業ログとドキュメント管理.md  # 新規作成
```

---

## 📖 使い分けガイド

### 統合版を使うべき場合
- 全体を一度に確認したい
- 検索機能で特定の情報を探したい
- オフラインで1ファイルとして保存したい
- 印刷して紙で確認したい

### 分割版を使うべき場合
- 特定のトピックだけ確認したい
- トークン数を節約したい
- モジュール単位で更新したい
- 段階的に学習したい

---

## 🔗 関連ドキュメント

- [利用ガイド](./利用ガイド.md): 統合版と分割版の使い分け
- [FAQ](../FAQ.md): よくある質問
- [用語集](../用語集.md): 用語の定義

---

**最終更新日**: 2025年11月22日
**管理者**: Claude Code Team
```

---

### Part 2: 統合版ファイル名の変更

#### 2-1. Worker用統合版のリネーム

**現在のファイル名**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件_Worker.md`
**新しいファイル名**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件_Worker_v2.7.md`

**手順**:
```bash
# macOSの場合
mv "/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件_Worker.md" \
   "/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件_Worker_v2.7.md"
```

#### 2-2. Reviewer用統合版のリネーム

**現在のファイル名**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件_Reviewer.md`
**新しいファイル名**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件_Reviewer_v1.5.md`

**手順**:
```bash
# macOSの場合
mv "/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件_Reviewer.md" \
   "/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件_Reviewer_v1.5.md"
```

---

### Part 3: Worker用分割版の更新

#### 3-1. 02_ファイル管理.md の更新

**ファイルパス**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/Worker/02_ファイル管理.md`

**追加位置**: ファイル末尾の「### バックアップ」セクション（391行目付近）を置き換え

**追加内容**:

```markdown
### バックアップ管理規約

#### 基本方針

**最重要原則**: すべてのファイル修正において、修正前に必ずバックアップを取る。

#### バックアップ取得基準（2段階）

##### レベル1: 必須バックアップ（修正前）
- **対象**: すべてのコードファイル・設定ファイルの修正
- **タイミング**: 修正を開始する前
- **命名規則**: `[元のファイル名].backup_YYYYMMDD_[作業指示書の要約]_before`
- **例**: `SimpleTrigger.jsx.backup_20251119_ダイアログ自動クローズ_before`

##### レベル2: 検証済みバックアップ（動作確認後）
- **対象**: 修正後、動作確認が完了したバージョン
- **タイミング**: テスト成功後、次の修正を開始する前
- **命名規則**: `[元のファイル名].backup_YYYYMMDD_[作業指示書の要約]_verified`
- **例**: `SimpleTrigger.jsx.backup_20251119_ダイアログ自動クローズ_verified`
- **重要**: このverifiedバージョンが次の修正のベースラインとなる

#### バックアップ取得手順

##### Workerの責任
1. 修正を開始する前に、必ずレベル1バックアップを作成
2. バックアップが作成されたことを確認
3. バックアップファイル名を作業ログに記録
4. 動作確認完了後、レベル2バックアップを作成
5. 作業ログに記録

##### 確認事項
- [ ] バックアップファイルが作成された
- [ ] ファイルサイズが0でない（空ファイルでない）
- [ ] バックアップファイル名が命名規則に従っている
- [ ] 作業ログにバックアップファイル名を記録した

#### バックアップの保存と管理

##### 保存場所
- **基本**: 元のファイルと同じディレクトリに保存
- **例外**: 大量のバックアップがある場合は `backups/YYYYMMDD/` に保存

##### 保存期間
- **レベル1（必須）**: 次の検証済みバックアップまで保持
- **レベル2（検証済み）**: 容量が許す限り無期限保持
- **クリーンアップ**: 容量が逼迫した場合のみ、ユーザー確認後に古いバックアップを削除

##### バックアップ対象
- **必須**: コードファイル（`.js`, `.jsx`, `.py`, `.bat`, `.ps1`）
- **必須**: 設定ファイル（`.json`, `.env`, `.config`, `.yaml`, `.ini`）
- **必須**: スクリプトファイル（`.sh`, `.cmd`）
- **必須**: ドキュメントファイル（`.md`）
- **必須**: ログファイル（`.log`, `.txt`）← 動作確認を保証するため

##### バックアップ対象外
- 一時ファイル（`*.tmp`, `*.temp`）
- 自動生成ファイル（`node_modules/`, `*.pyc`, `__pycache__/`）
- Git管理対象外のファイル
- ビルド成果物（`dist/`, `build/`）

##### 大容量ファイルの扱い
- **基準**: 1つで数GB以上、または複数で数百MB以上
- **対応**: Reviewerが作業指示書作成時にユーザーに確認
- **例**: データベースダンプ、.aepプロジェクト、動画ファイル等

#### 作業ログへの記録

##### テンプレート
```markdown
## バックアップ履歴

### [作業指示書の要約]（YYYY-MM-DD）

**作業指示書**: `YYYYMMDD_作業指示_[内容].md`

**バックアップファイル**:
- **レベル1（修正前）**: `[ファイル名].backup_YYYYMMDD_[要約]_before`
  - 作成日時: YYYY-MM-DD HH:MM
  - ファイルサイズ: XXX KB
  - 元ファイルの状態: [前回のverifiedバージョン]

- **レベル2（検証済み）**: `[ファイル名].backup_YYYYMMDD_[要約]_verified`
  - 作成日時: YYYY-MM-DD HH:MM
  - ファイルサイズ: XXX KB
  - 動作確認: ✅ 成功
```

#### バックアップの復元手順

```bash
# ステップ1: 現在のファイルをバックアップ（念のため）
copy "[元のファイル]" "[元のファイル].backup_before_restore_YYYYMMDD"

# ステップ2: バックアップから復元
copy "[バックアップファイル]" "[元のファイル]"

# ステップ3: 復元を確認
dir "[元のファイル]"

# ステップ4: 動作確認
# （テストを実施）
```

##### 復元の記録
```markdown
## ロールバック履歴

### [復元理由]（YYYY-MM-DD）

- **復元日時**: YYYY-MM-DD HH:MM
- **復元元**: `[バックアップファイル名]`
- **復元先**: `[元のファイル名]`
- **理由**: [詳細な理由]
- **復元前のバックアップ**: `[元のファイル].backup_before_restore_YYYYMMDD`
- **復元後の動作確認**: [✅ 成功 / ❌ 失敗]
```

---
```

**修正方法**:
1. Readツールで現在の `02_ファイル管理.md` を確認
2. 391行目付近の既存の「### バックアップ」セクション（簡易版）を探す
3. Editツールで、既存の「### バックアップ」セクションを上記の詳細版に置き換え

---

### Part 4: Reviewer用分割版の更新

#### 4-1. 02_レビュープロセスとワークフロー.md の更新

**ファイルパス**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/Reviewer/02_レビュープロセスとワークフロー.md`

**追加位置**: 「### ステップ0.5: ユーザーの事前指示の確認」の後、「### ステップ1: 対象の確認」の前

**追加内容**:

```markdown
---

### ステップ0.6: 修正指示書へのバックアップ手順の明記（必須）

**最重要**: 修正指示書を作成する際、必ずバックアップ手順を含める。

#### バックアップ手順の記載が必要な理由

1. **Workerへの明確な指示**: バックアップのタイミングと方法を明確化
2. **バックアップの一貫性**: すべての修正で確実にバックアップが取られる
3. **作業指示書との紐付け**: バックアップファイル名に作業指示書の要約を含める
4. **復元の容易性**: どの作業指示書で修正されたかが一目で分かる

#### 修正指示書へのバックアップ手順テンプレート

**すべての修正指示書に以下を含めること**:

```markdown
## バックアップ情報

**作業指示書の要約**: [重要なキーワードのみ抽出]

**バックアップファイル名**:
- レベル1（修正前）: `[ファイル名].backup_YYYYMMDD_[要約]_before`
- レベル2（検証済み）: `[ファイル名].backup_YYYYMMDD_[要約]_verified`

**例**:
- レベル1: `SimpleTrigger.jsx.backup_20251119_ダイアログ自動クローズ_before`
- レベル2: `SimpleTrigger.jsx.backup_20251119_ダイアログ自動クローズ_verified`

---

## 実装手順

### ステップ1: バックアップの作成（レベル1: 必須）

**重要**: 修正を開始する前に、必ずバックアップを作成してください。

\`\`\`bash
# [ファイル名] のバックアップ（レベル1: 修正前）
copy "[元のパス]" "[元のパス].backup_YYYYMMDD_[要約]_before"
\`\`\`

**確認事項**:
- [ ] バックアップファイルが作成された
- [ ] ファイルサイズが0でない
- [ ] 作業ログにバックアップファイル名を記録した

### ステップ2: 修正の実施
[修正内容を記載]

### ステップ3: 動作確認
[テスト手順を記載]

### ステップ4: バックアップの作成（レベル2: 検証済み）

**テスト成功後**: 検証済みバックアップを作成してください。

\`\`\`bash
# [ファイル名] のバックアップ（レベル2: 検証済み）
copy "[元のパス]" "[元のパス].backup_YYYYMMDD_[要約]_verified"
\`\`\`

**確認事項**:
- [ ] 動作確認が完了している
- [ ] バックアップファイルが作成された
- [ ] 作業ログにバックアップファイル名を記録した
```
\`\`\`

#### 作業指示書の要約の作り方

修正指示書のファイル名から重要なキーワードのみを抽出：

| 修正指示書ファイル名 | 要約（バックアップに使用） |
|---------------------|--------------------------|
| `20251119_作業指示_AE自動化_ダイアログ自動クローズ機能追加.md` | `ダイアログ自動クローズ` |
| `20251120_修正指示_AE自動化_エラーハンドリング強化.md` | `エラーハンドリング強化` |
| `20251121_作業指示_DB最適化_インデックス追加.md` | `DB最適化_インデックス追加` |

#### 大容量ファイルの確認

**基準**: 1つで数GB以上、または複数で数百MB以上のファイル

**確認が必要な場合のテンプレート**:

```markdown
## バックアップ対象の確認

### 大容量ファイルの確認
- **ファイル**: [ファイル名]（[サイズ]）
- **確認事項**: このファイルをバックアップしますか？
- **ユーザー判断**: [待機中 / 必要 / 不要]
```

**例**:
- データベースダンプファイル（数GB）
- After Effects プロジェクトファイル（.aep）（数百MB）
- 動画ファイル（数GB）

#### バックアップ手順の記載チェックリスト

修正指示書を作成する前に、以下を確認：

- [ ] 「バックアップ情報」セクションを追加した
- [ ] 作業指示書の要約を決定した
- [ ] レベル1バックアップのファイル名を明記した
- [ ] レベル2バックアップのファイル名を明記した
- [ ] 「ステップ1: バックアップの作成（レベル1）」を追加した
- [ ] バックアップコマンドを具体的に記載した
- [ ] 「ステップ4: バックアップの作成（レベル2）」を追加した
- [ ] 大容量ファイルがある場合、ユーザー確認セクションを追加した

---
```

**修正方法**:
1. Readツールで現在の `02_レビュープロセスとワークフロー.md` を確認
2. 「### ステップ0.5: ユーザーの事前指示の確認」セクションの終わりを探す
3. Editツールで、上記内容を「### ステップ1: 対象の確認」の前に挿入

---

#### 4-2. 04_作業ログとドキュメント管理.md の新規作成

**ファイルパス**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/Reviewer/04_作業ログとドキュメント管理.md`

**内容**:

```markdown
# 作業ログとドキュメント管理 - Reviewer用

## 📌 このモジュールについて

**用途**: Reviewerの作業ログ記録とドキュメント管理
**必読条件**: レビュー・調査・分析・ドキュメント作成作業を行う際に必読
**関連モジュール**: 02_レビュープロセスとワークフロー.md（プロセス詳細）

---

## 作業ログ・メモの記録

### 必須ルール

**Reviewerも各日付フォルダに作業ログを記録する**

- WorkerとReviewerの作業を同じworklogファイルに記録
- Reviewerの調査・分析・作業指示書作成などの作業をすべて記録
- 1日の作業全体が一つのworklogで把握できるようにする

### ファイル形式

- ファイル名: `YYYYMMDD_worklog.md`
- 例: `20251119_worklog.md`
- 場所: 日付フォルダ直下

### Reviewerが記録すべき作業内容

1. **調査・分析作業**
   - コードレビュー実施
   - 問題点の調査
   - バックアップ状況調査
   - ログファイル分析
   - 既存システムの動作確認

2. **ドキュメント作成**
   - 作業指示書の作成
   - 修正指示書の作成
   - 調査結果レポートの作成
   - レビュー結果の記録

3. **レビュー実施**
   - Workerの成果物レビュー
   - 承認・却下の判断
   - フィードバックの提供

4. **ユーザーとのやり取り**
   - 要件確認
   - 事前指示の確認
   - 技術的な質問への回答

### Reviewer用テンプレート

```markdown
# 作業ログ - YYYY年MM月DD日

## Phase X: [フェーズ名]（Reviewer作業）

### 作業目的
- [今回の調査・レビュー・作業指示書作成の目的]

### 実施内容

#### 調査・分析
1. [実施した調査1]
   - 調査対象: [ファイル名やシステム名]
   - 調査方法: [Grep、Read、WebSearchなど]
   - 調査結果: [発見した内容]

2. [実施した調査2]
   - 調査対象: [ファイル名やシステム名]
   - 調査方法: [使用したツール]
   - 調査結果: [発見した内容]

#### 作成・修正したドキュメント
- `YYYYMMDD_作業指示_[対象名].md`: [作業指示書の概要]
- `YYYYMMDD_修正指示_[対象名].md`: [修正指示書の概要]
- `YYYYMMDD_[調査結果名].md`: [調査結果レポートの概要]

#### レビュー実施（実施した場合のみ）
- 対象: `[ファイル名]`
- 結果: [承認/条件付き承認/却下]
- 主な指摘事項:
  - [指摘事項1]
  - [指摘事項2]

#### ユーザーとのやり取り
- [ユーザーからの質問]: [回答内容]
- [確認事項]: [確認結果]

### 発見した問題点・課題
- [問題点1]: [詳細と影響範囲]
- [問題点2]: [詳細と対応方針]

### 提案・推奨事項
- [提案1]: [理由と期待される効果]
- [提案2]: [理由と実装方法]

### 次回タスク（Workerへの依頼含む）
- [ ] [Reviewer自身の次回タスク1]
- [ ] [Workerに依頼する作業1] → 作業指示書: `[ファイル名]`
- [ ] [Workerに依頼する作業2] → 修正指示書: `[ファイル名]`

### メモ・備考
- [その他気づいた点や重要な情報]
- [参考にしたドキュメントやURL]
```

### 作業ログの更新タイミング

**重要**: Reviewerも作業の進捗に応じて**随時更新**する

1. **調査開始時**
   - 調査目的を記載
   - 調査予定の内容を記載

2. **調査中**
   - 調査結果を随時追記
   - 発見した問題点・課題を記録

3. **作業指示書・修正指示書作成時**
   - 作成したドキュメント名と概要を記載
   - 作成理由と背景を記録

4. **レビュー実施後**
   - レビュー結果を記載
   - 主な指摘事項を記録

5. **作業完了時**
   - 最終的な結論を記載
   - 次回タスクを整理
   - Workerへの依頼内容を明記

### WorkerとReviewerの共同記録

**重要**: 1つのworklogにWorkerとReviewerの作業を時系列で記録

**例**:
```markdown
# 作業ログ - 2025年11月19日

## Phase 1: バックアップ基準の調査（Reviewer作業）

### 作業目的
- 現在のバックアップ状況を調査
- バックアップ基準を定義

### 実施内容
[調査内容]

---

## Phase 2: バックアップ基準の作成（Reviewer作業）

### 作業目的
- 2段階バックアップシステムの定義

### 実施内容
[作成したドキュメント]

---

## Phase 3: 作業前提条件の更新（Reviewer作業）

### 作業目的
- 作業前提条件にバックアップ基準を追加

### 実施内容
[更新内容]

---

## Phase 4: ダイアログ自動クローズ機能の実装（Worker作業）

### 作業目的
- 作業指示書に従ってダイアログ自動クローズ機能を実装

### 実施内容
[Worker が実施した作業]
```

### 作業完了報告時のルール

**重要**: Reviewerも作業完了後にユーザーに報告する際は、以下を明記すること

1. **作業記録の完了を明記**
   - 「作業ログに記録済み」または「worklogに記載済み」と明記
   - 作業ログのファイルパスを提示
   - 例: 「詳細は `/Users/hiraihironori/Desktop/WorkSpace/20251119/20251119_worklog.md` に記録済みです」

2. **作成したドキュメントのパスを明示**
   - 作業指示書、修正指示書、調査結果レポートなどのファイルパスを提示
   - ユーザーが確認しやすいように明記

---

## レビュー結果の活用

### 記録の保管

**レビュー結果の保存場所**:
- 日付フォルダ内: `YYYYMMDD/レビュー結果_YYYYMMDD_対象名.md`
- 重要なレビューはDOCS/に保管

### 傾向分析

定期的に以下を確認：
- 頻繁に指摘される問題点
- 改善が見られる領域
- 継続的な課題
- ベストプラクティスの共有

---

**最終更新日**: 2025年11月22日
**バージョン**: 統合版v1.5に対応
```

**作成方法**:
1. Writeツールで上記内容を新規ファイルとして作成

---

#### 4-3. 00_INDEX.md の更新

**ファイルパス**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/Reviewer/00_INDEX.md`

**修正位置**: 「### 03_チェックリストと評価基準.md」セクションの後

**追加内容**:

```markdown
---

### 04_作業ログとドキュメント管理.md
**用途**: Reviewerの作業ログ記録とドキュメント管理
**必読条件**: レビュー・調査・分析・ドキュメント作成作業を行う際
**内容**:
- 作業ログ・メモの記録（Reviewer用）
- Reviewerが記録すべき作業内容（調査・分析、ドキュメント作成、レビュー実施、ユーザーとのやり取り）
- 作業ログの更新タイミング
- WorkerとReviewerの共同記録
- 作業完了報告時のルール
- レビュー結果の活用

---
```

**修正方法**:
1. Readツールで現在の `00_INDEX.md` を確認
2. 「### 03_チェックリストと評価基準.md」セクションの終わりを探す
3. Editツールで上記内容を追加

---

#### 4-4. 00_QUICK_REFERENCE.md の更新

**ファイルパス**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/Reviewer/00_QUICK_REFERENCE.md`

**修正位置**: 「## 📚 関連モジュール」セクション

**追加内容**:

```markdown
- **04_作業ログとドキュメント管理.md**: 作業ログ記録とドキュメント管理
```

**修正方法**:
1. Readツールで現在の `00_QUICK_REFERENCE.md` の末尾を確認
2. 「## 📚 関連モジュール」セクションに上記を追加

---

### Part 5: 更新履歴管理フォルダの作成

#### 5-1. changelog/ フォルダの作成

**フォルダパス**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/changelog/`

**手順**:
```bash
# changelogフォルダを作成
mkdir -p "/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/changelog"
```

---

#### 5-2. changelog/INDEX.md の作成

**ファイルパス**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/changelog/INDEX.md`

**内容**:

```markdown
# 作業前提条件ドキュメント - 更新履歴

このドキュメントは、作業前提条件ドキュメント（統合版・分割版）の更新履歴を管理します。

---

## 📌 最新バージョン

- **Worker用**: v2.7（2025-11-19）
- **Reviewer用**: v1.5（2025-11-19）

詳細は [VERSION.md](../VERSION.md) を参照

---

## 🔄 更新履歴（新しい順）

### 2025-11-22: 統合版から分割版への更新
- **対象**: Worker v2.7、Reviewer v1.5
- **内容**:
  - 統合版の最新内容を分割版に反映
  - VERSION.md作成（バージョン管理の一元化）
  - 統合版ファイル名にバージョン番号追加
  - changelog/フォルダ作成（更新履歴管理）
- **ドキュメント**: [2025-11-22_統合版から分割版への更新.md](./2025-11-22_統合版から分割版への更新.md)
- **影響範囲**:
  - Worker分割版: `02_ファイル管理.md`
  - Reviewer分割版: `02_レビュープロセスとワークフロー.md`, `04_作業ログとドキュメント管理.md`（新規）
  - VERSION.md（新規）
  - 統合版ファイル名変更
- **実装担当**: [Worker名]
- **レビュー担当**: Claude Code (Reviewer)
- **ステータス**: 🔄 実装中

---

### 2025-11-19: バックアップ管理規約の詳細化
- **対象**: Worker v2.7、Reviewer v1.4-v1.5
- **内容**:
  - 2段階バックアップシステムの導入（レベル1: 修正前、レベル2: 検証済み）
  - バックアップ命名規則の統一（作業指示書の要約を含む）
  - 作業ログへの記録テンプレート追加
  - Reviewer作業ログ記録の必須化
- **影響範囲**: Worker統合版、Reviewer統合版
- **ステータス**: ✅ 完了

---

### 2025-11-17: レビュー結果と修正指示書の分離
- **対象**: Reviewer v1.3
- **内容**:
  - レビュー結果と修正指示書を別ファイルとして作成
  - ドキュメントのバージョニングルールを追加
  - バージョン番号管理の明確化（v1, v2, v3...）
- **影響範囲**: Reviewer分割版
- **ステータス**: ✅ 完了

---

### 2025-11-14: バッチファイル規約の追加
- **対象**: Worker v2.6
- **内容**:
  - 変数名・関数名・ラベル名は英数字のみ使用を義務化（日本語禁止）
  - 日本語パスの取り扱いルール明記（必ずダブルクォート）
  - 文字エンコーディング推奨設定（UTF-8 with BOM等）
  - スクリプト作成時のチェックリスト追加
- **影響範囲**: Worker統合版
- **ステータス**: ✅ 完了

---

### 2025-11-14: デバッグ・トラブルシューティング規約の追加
- **対象**: Worker v2.5
- **内容**:
  - 中間ファイルの命名規則を統一（_debug, _fix[番号], _v[メジャー].[マイナー]）
  - デバッグワークフロー（4フェーズ）を定義
  - debug_files/ フォルダの活用方法を明記
- **影響範囲**: Worker統合版
- **ステータス**: ✅ 完了

---

### 2025-11-14: 指示の優先順位と矛盾時の対処ルール
- **対象**: Worker v2.4、Reviewer v1.2
- **内容**:
  - 5段階の指示優先順位を定義（ユーザーの直接指示が最優先）
  - 矛盾発見時の対処手順を明記（作業停止→ユーザー確認→指示待ち）
  - バージョン番号管理の特別ルールを追加
  - Reviewerのユーザー事前指示確認プロセスを追加
- **影響範囲**: Worker統合版、Reviewer統合版
- **ステータス**: ✅ 完了

---

### 2025-11-14: Workspace全体把握機能の追加
- **対象**: Reviewer v1.1
- **内容**:
  - レビュープロセスに「ステップ0: Workspace全体の把握」を追加
  - Globツールでworkspace全体を探索する手順を定義
  - 全体把握のチェックリストを追加
- **影響範囲**: Reviewer統合版
- **ステータス**: ✅ 完了

---

### 2025-11-13: ハルシネーション抑止ルールの追加・強化
- **対象**: Worker v2.2-v2.3
- **内容**:
  - 確認してから発言・実装する原則を明記
  - ファイル内容を正確に確認せずに説明・記載することを禁止
  - 変数名、パラメータ名、文字種などを一字一句正確に確認する原則を明記
- **影響範囲**: Worker統合版
- **ステータス**: ✅ 完了

---

### 2025-11-13: Claude Code 作業原則・行動指針の追加
- **対象**: Worker v2.1
- **内容**:
  - 前提条件・目的の厳守ルールを追加（前提を覆す提案の明示的禁止）
  - 提案の一貫性と品質に関するルール追加
  - ツール・技術選定の原則を追加
- **影響範囲**: Worker統合版
- **ステータス**: ✅ 完了

---

### 2025-11-13: 大幅な機能追加
- **対象**: Worker v2.0
- **内容**:
  - 出力ファイル・生成ファイルの管理ルール追加
  - 作業ログ・メモの記録ルール追加（YYYYMMDD_worklog.md形式）
  - 環境変数・設定ファイルの管理ルール追加
  - 特殊ツール固有のルール追加（After Effects、Unreal Engine）
- **影響範囲**: Worker統合版
- **ステータス**: ✅ 完了

---

## 📊 統計情報

- **総更新回数**: 10回
- **Worker用更新**: 7回
- **Reviewer用更新**: 3回
- **最終更新日**: 2025-11-22

---

## 🔍 更新タイプ別分類

### 機能追加（6回）
- バックアップ管理規約の詳細化
- バッチファイル規約の追加
- 作業ログ記録の必須化
- デバッグ・トラブルシューティング規約
- Workspace全体把握機能
- 大幅な機能追加（v2.0）

### ルール明確化（3回）
- レビュー結果と修正指示書の分離
- 指示の優先順位と矛盾時の対処
- ハルシネーション抑止ルール

### 構造改善（1回）
- 統合版から分割版への更新（今回）

---

## 📁 フォルダ構造

```
DOCS/作業前提条件/
├── VERSION.md                              # バージョン情報（一元管理）
├── changelog/                              # 更新履歴フォルダ
│   ├── INDEX.md                            # このファイル（更新履歴一覧）
│   ├── 2025-11-22_統合版から分割版への更新.md
│   └── ...（今後の更新ドキュメント）
├── Reviewer/                               # Reviewer用分割版
├── Worker/                                 # Worker用分割版
└── 利用ガイド.md
```

---

## 🔗 関連ドキュメント

- [VERSION.md](../VERSION.md): バージョン情報の詳細
- [利用ガイド.md](../利用ガイド.md): 統合版と分割版の使い分け
- [Worker用統合版](../作業前提条件_Worker_v2.7.md)
- [Reviewer用統合版](../作業前提条件_Reviewer_v1.5.md)

---

**管理者**: Claude Code Team
**最終更新日**: 2025-11-22
```

**作成方法**:
1. Writeツールで上記内容を新規ファイルとして作成

---

#### 5-3. 過去の作業前提条件更新ドキュメントを changelog/ に移動

**目的**: archiveフォルダから作業前提条件関連の更新ドキュメントをchangelog/に移動し、一元管理する。

##### 移動対象ファイル（2025-11-19: バックアップ管理規約関連）

**ファイル1**: バックアップ基準の調査と提案
- **元**: `/Users/hiraihironori/Desktop/WorkSpace/archive/2025/11-November/20251119/20251119_バックアップ基準の調査と提案.md`
- **先**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/changelog/2025-11-19_バックアップ基準の調査と提案.md`

**ファイル2**: バックアップ基準最終版
- **元**: `/Users/hiraihironori/Desktop/WorkSpace/archive/2025/11-November/20251119/20251119_バックアップ基準_最終版.md`
- **先**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/changelog/2025-11-19_バックアップ基準_最終版.md`

##### 移動対象ファイル（2025-11-17: 作業ログ記録関連）

**ファイル3**: 作業ログへのテスト結果記載
- **元**: `/Users/hiraihironori/Desktop/WorkSpace/archive/2025/11-November/20251117/20251117_修正指示_作業ログ_テスト結果記載_v1.md`
- **先**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/changelog/2025-11-17_作業ログへのテスト結果記載.md`

##### 移動手順

```bash
# 2025-11-19 バックアップ基準関連（2ファイル）
mv "/Users/hiraihironori/Desktop/WorkSpace/archive/2025/11-November/20251119/20251119_バックアップ基準の調査と提案.md" \
   "/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/changelog/2025-11-19_バックアップ基準の調査と提案.md"

mv "/Users/hiraihironori/Desktop/WorkSpace/archive/2025/11-November/20251119/20251119_バックアップ基準_最終版.md" \
   "/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/changelog/2025-11-19_バックアップ基準_最終版.md"

# 2025-11-17 作業ログ記録関連（1ファイル）
mv "/Users/hiraihironori/Desktop/WorkSpace/archive/2025/11-November/20251117/20251117_修正指示_作業ログ_テスト結果記載_v1.md" \
   "/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/changelog/2025-11-17_作業ログへのテスト結果記載.md"
```

---

#### 5-4. changelog/INDEX.md の更新（過去のファイル参照追加）

**ファイルパス**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/changelog/INDEX.md`

**修正箇所1**: 「### 2025-11-19: バックアップ管理規約の詳細化」セクション

既存の内容：
```markdown
- **影響範囲**: Worker統合版、Reviewer統合版
- **ステータス**: ✅ 完了
```

この後に以下を追加：
```markdown
- **関連ドキュメント**:
  - [バックアップ基準の調査と提案](./2025-11-19_バックアップ基準の調査と提案.md)
  - [バックアップ基準_最終版](./2025-11-19_バックアップ基準_最終版.md)
```

---

**修正箇所2**: 「### 2025-11-17: レビュー結果と修正指示書の分離」セクション

既存の内容：
```markdown
- **影響範囲**: Reviewer分割版
- **ステータス**: ✅ 完了
```

この後に以下を追加：
```markdown
- **関連ドキュメント**:
  - [作業ログへのテスト結果記載](./2025-11-17_作業ログへのテスト結果記載.md)
```

**修正方法**:
1. Readツールで現在の `INDEX.md` を確認
2. Editツールで上記の追加を2箇所実施

---

### Part 6: 作業時間見積もり

| 作業項目 | 見積もり時間 |
|---------|------------|
| VERSION.md の作成 | 5分 |
| 統合版ファイル名の変更（2ファイル） | 2分 |
| Worker用分割版の更新（02_ファイル管理.md） | 10分 |
| Reviewer用分割版の更新（02_レビュープロセス.md） | 10分 |
| Reviewer用新規ファイル作成（04_作業ログ.md） | 5分 |
| INDEX・QUICK_REFERENCE更新 | 5分 |
| **changelog/フォルダ作成とINDEX.md作成** | **10分** |
| **過去ファイルの移動（3ファイル）** | **5分** |
| **INDEX.md更新（過去ファイル参照追加）** | **3分** |
| **合計** | **約55分** |

---

## ✅ 作業完了後の確認項目

### VERSION.md
- [ ] VERSION.mdが `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/` に作成された
- [ ] Worker v2.7、Reviewer v1.5のバージョン情報が記載されている
- [ ] 変更履歴が正しく記載されている

### 統合版リネーム
- [ ] `作業前提条件_Worker.md` が `作業前提条件_Worker_v2.7.md` にリネームされた
- [ ] `作業前提条件_Reviewer.md` が `作業前提条件_Reviewer_v1.5.md` にリネームされた
- [ ] リネーム後のファイルが正常に読み込める

### Worker用分割版
- [ ] `02_ファイル管理.md` にバックアップ管理規約が追加された
- [ ] 2段階バックアップの説明が含まれている
- [ ] 作業ログへの記録テンプレートが含まれている

### Reviewer用分割版
- [ ] `02_レビュープロセスとワークフロー.md` にステップ0.6が追加された
- [ ] バックアップ手順のテンプレートが含まれている
- [ ] `04_作業ログとドキュメント管理.md` が新規作成された
- [ ] 作業ログ記録のルールとテンプレートが含まれている
- [ ] `00_INDEX.md` が更新され、新しいモジュールが記載された
- [ ] `00_QUICK_REFERENCE.md` が更新された

### 更新履歴管理（changelog/）
- [ ] `changelog/` フォルダが `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/` に作成された
- [ ] `changelog/INDEX.md` が作成され、更新履歴が正しく記載されている
- [ ] 今回の修正指示書が `changelog/2025-11-22_統合版から分割版への更新.md` に移動された
- [ ] INDEX.mdに今回の更新（2025-11-22）が記載されている
- [ ] 過去の更新履歴（v2.7まで）が正しく記載されている

### 過去ファイルの移動
- [ ] `2025-11-19_バックアップ基準の調査と提案.md` が changelog/ に移動された
- [ ] `2025-11-19_バックアップ基準_最終版.md` が changelog/ に移動された
- [ ] `2025-11-17_作業ログへのテスト結果記載.md` が changelog/ に移動された
- [ ] INDEX.md の2025-11-19セクションに関連ドキュメント参照が追加された
- [ ] INDEX.md の2025-11-17セクションに関連ドキュメント参照が追加された

---

## 📝 注意事項

1. **バックアップ**: 修正前に必ず既存ファイルのバックアップを取ること
2. **文字エンコーディング**: すべてのファイルはUTF-8（BOM なし）で保存すること
3. **改行コード**: LF（Unix形式）を使用すること
4. **確認**: 各修正後、ファイルが正常に読み込めることを確認すること

---

## 🔗 関連ドキュメント

- **統合版Worker**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件_Worker_v2.7.md`
- **統合版Reviewer**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件_Reviewer_v1.5.md`
- **分割版Worker**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/Worker/`
- **分割版Reviewer**: `/Users/hiraihironori/Desktop/WorkSpace/DOCS/作業前提条件/Reviewer/`

---

**作成日**: 2025年11月22日
**Reviewer**: Claude Code (Reviewer)
**バージョン**: v1
