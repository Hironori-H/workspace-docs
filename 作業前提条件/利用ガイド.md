# 作業前提条件（分割版）利用ガイド

## 📌 このドキュメントについて

**作成日**: 2025年11月14日
**バージョン**: 1.0.0
**対象**: Claude Code Max / Proプランユーザー

このガイドは、作業前提条件の分割版（モジュール化版）の使い方を説明します。

---

## 🎯 分割版の特徴

### メリット

1. **トークン使用量を大幅削減**（77-99%削減）
   - 通常作業: 35,000トークン → 4,300トークン（88%削減）
   - 超簡単な作業: 35,000トークン → 250トークン（99%削減）

2. **プロプランでも安心**
   - トークン制限が厳しくても、必要な部分のみ読み込むため問題なし

3. **読み込み時間が短縮**
   - 統合版: 30-40秒 → 分割版: 5-15秒

4. **自動判定で手間なし**
   - INDEX.mdを読めば、必要なモジュールを自動的に判定・読み込み

---

## 📁 フォルダ構造

```
DOCS/作業前提条件/
├── Worker_v2.7/                       ← Worker（実装担当）用 (v2.7)
│   ├── 00_QUICK_REFERENCE.md          ← クイックリファレンス（250トークン）
│   ├── 00_INDEX.md                    ← インデックス（自動判定フロー含む、800トークン）
│   ├── 01_基本ルール.md               ← 全作業で必読（1,500トークン）
│   ├── 02_ファイル管理.md             ← ファイル管理時に読む（1,500トークン）
│   ├── 03_バッチファイル規約.md       ← バッチ作成時に読む（2,000トークン）
│   ├── 04_デバッグ規約.md             ← デバッグ時に読む（2,000トークン）
│   ├── 05_指示の優先順位.md           ← 矛盾発見時に読む（1,500トークン）
│   ├── 06_ハルシネーション抑止.md     ← 複雑な作業時に読む（1,000トークン）
│   └── 07_特殊ツール.md               ← AE/UE使用時に読む（1,500トークン）
│
└── Reviewer_v1.5/                     ← Reviewer（レビュー担当）用 (v1.5)
    ├── 00_QUICK_REFERENCE.md          ← クイックリファレンス（250トークン）
    ├── 00_INDEX.md                    ← インデックス（500トークン）
    ├── 01_基本ルールとレビュー原則.md  ← 全レビューで必読（1,000トークン）
    ├── 02_レビュープロセス.md         ← レビュー手順（2,000トークン）
    ├── 03_チェックリスト.md           ← チェックリスト（1,500トークン）
    └── 04_作業ログとドキュメント管理.md ← 作業ログ記録（1,500トークン）
```

---

## 🚀 使い方

### Worker作業の場合

#### ケース1: 超簡単な作業（ファイル名変更、軽微な修正）

**指示例**:
```
QUICK_REFERENCEを読んで、script.pyをdata_processor.pyにリネームして
```

**読み込むファイル**:
- `Worker_v2.7/00_QUICK_REFERENCE.md` のみ

**トークン数**: 250トークン（**99%削減**）

---

#### ケース2: 通常の作業（バッチファイル作成、デバッグ等）

**指示例**:
```
INDEXを読んで、UE起動バッチファイルを作成して
```

**Claud Codeの動作**:
1. `Worker_v2.7/00_INDEX.md` を読む（800トークン）
2. 作業内容を自動判定：「バッチファイル作成」を検出
3. 必要なモジュールを自動読み込み：
   - `01_基本ルール.md`（1,500トークン）
   - `03_バッチファイル規約.md`（2,000トークン）

**トークン数**: 4,300トークン（**88%削減**）

---

#### ケース3: 複雑な作業（複数のタスク）

**指示例**:
```
INDEXを読んで、新規バッチ作成と既存バッチのデバッグをして
```

**Claude Codeの動作**:
1. `Worker_v2.7/00_INDEX.md` を読む
2. 作業内容を自動判定：「バッチ作成」+「デバッグ」を検出
3. 必要なモジュールを自動読み込み：
   - `01_基本ルール.md`
   - `03_バッチファイル規約.md`
   - `04_デバッグ規約.md`

**トークン数**: 6,300トークン（**82%削減**）

---

### Reviewer作業の場合

#### ケース1: 簡単なレビュー

**指示例**:
```
Reviewer用のQUICK_REFERENCEを読んで、このファイルをレビューして
```

**トークン数**: 250トークン

---

#### ケース2: 通常のレビュー

**指示例**:
```
Reviewer用のINDEXを読んで、20251114/UE_automationをレビューして
```

**Claude Codeの動作**:
1. `Reviewer_v1.5/00_INDEX.md` を読む
2. レビュータイプを判定：「スクリプトレビュー」を検出
3. 必要なモジュールを読み込み：
   - `01_基本ルールとレビュー原則.md`
   - `02_レビュープロセス.md`
   - `03_チェックリスト.md`

**トークン数**: 約3,500トークン（**75%削減**）

---

## 💡 便利なテンプレート

コピーして使えるテンプレート集です。

### Worker作業

```
# 超簡単な作業
DOCS/作業前提条件/Worker_v2.7/00_QUICK_REFERENCE.mdを読んで、〇〇して

# 通常の作業
DOCS/作業前提条件/Worker_v2.7/00_INDEX.mdを読んで、〇〇して

# 特定モジュールを指定したい場合
DOCS/作業前提条件/Worker_v2.7/00_INDEX.mdと03_バッチファイル規約.mdを読んで、〇〇して
```

### Reviewer作業

```
# 簡単なレビュー
DOCS/作業前提条件/Reviewer_v1.5/00_QUICK_REFERENCE.mdを読んで、〇〇をレビューして

# 通常のレビュー
DOCS/作業前提条件/Reviewer_v1.5/00_INDEX.mdを読んで、〇〇をレビューして
```

---

## 📊 トークン使用量の比較

| 作業タイプ | 統合版 | 分割版 | 削減率 |
|----------|-------|-------|-------|
| 超簡単な作業 | 35,000 | 250 | 99% |
| 簡単な作業 | 35,000 | 2,300 | 93% |
| バッチ作成 | 35,000 | 4,300 | 88% |
| デバッグ | 35,000 | 4,300 | 88% |
| 複雑な作業 | 35,000 | 6,300 | 82% |
| レビュー | 20,000 | 3,500 | 75% |

---

## ⚠️ 注意事項

### 1. 統合版も残してあります

分割版の運用テスト中は、統合版も残してあります。

**統合版の場所**:
- `DOCS/作業前提条件_Worker.md`
- `DOCS/作業前提条件_Reviewer.md`

問題があれば、いつでも統合版に戻せます。

---

### 2. 作業内容が不明な場合

Claude Codeが作業内容を判定できない場合、質問が来ます。

**例**:
```
この作業は以下のどれに該当しますか？
- バッチファイル作成
- デバッグ・エラー修正
- ファイル整理・管理
- その他
```

選択肢から選ぶだけでOKです。

---

### 3. バージョン管理

**バージョン確認方法**:
- フォルダ名を見る: `Worker_v2.7/`, `Reviewer_v1.5/`
- VERSION.mdを確認: `DOCS/作業前提条件/VERSION.md`

**更新履歴の確認**:
- `DOCS/作業前提条件/VERSION.md`: 全バージョンの変更履歴
- `DOCS/作業前提条件/changelog/INDEX.md`: 更新作業の詳細記録

**バージョン番号の意味**:
- メジャーバージョン（v2.0 → v3.0）: 構造的な大幅変更
- マイナーバージョン（v2.7 → v2.8）: 新機能・ルール追加

---

## 🔄 今後の運用方針

### Phase 1: テスト運用（1-2週間）

- 分割版と統合版の両方を保持
- 実際の使用感を確認
- トークン削減効果を測定

### Phase 2: 調整

- 必要に応じてモジュール構成を調整
- INDEX.mdの判定フローを改善

### Phase 3: 本格運用

- 分割版をメインに移行
- 統合版は段階的に廃止を検討

---

## ❓ FAQ

### Q1: 統合版と分割版、どちらを使うべき？

**A**: 以下を参考にしてください。

| 状況 | 推奨 |
|-----|-----|
| プロプラン使用中 | 分割版 |
| Maxプラン使用中 | どちらでもOK（分割版が効率的） |
| 超簡単な作業のみ | 分割版（QUICK_REFERENCE） |
| 全情報が必要 | 統合版でもOK |

---

### Q2: INDEXを読んだ後、何が起こる？

**A**: Claude Codeが自動的に以下を行います。

1. ユーザーの指示を分析
2. 必要なモジュールを判定
3. 該当モジュールを自動読み込み
4. 作業を開始

ユーザーは何もする必要がありません。

---

### Q3: 特定のモジュールだけ読みたい場合は？

**A**: 直接指定できます。

```
DOCS/作業前提条件/Worker_v2.7/03_バッチファイル規約.mdを読んで、〇〇して
```

ただし、`01_基本ルール.md` は必ず読むことを推奨します。

---

### Q4: プロプランでトークンが足りなくなる？

**A**: 分割版なら大丈夫です。

**例**: プロプランのコンテキスト制限が50,000トークンの場合
- 統合版: 35,000トークン（70%消費）← 厳しい
- 分割版: 4,300トークン（8.6%消費）← 余裕

---

### Q5: バージョンアップはどうなる？

**A**: `VERSION.txt` で一元管理します。

各モジュールを更新したら、`VERSION.txt` に変更履歴を記録します。

---

## 📞 トラブルシューティング

### 問題1: INDEX.mdを読んでも、何も読み込まれない

**原因**: 作業内容が不明瞭

**解決策**: もう一度、具体的に指示してください。

```
# 不明瞭
INDEXを読んで、作業して

# 明確
INDEXを読んで、launch_automation.batを作成して
```

---

### 問題2: トークンがまだ多い

**原因**: 複数モジュールが読み込まれている

**解決策**: 超簡単な作業なら、QUICK_REFERENCEのみ読んでください。

---

### 問題3: 統合版と分割版で内容が違う？

**原因**: 分割版作成時のタイムラグ

**解決策**: 分割版の `VERSION.txt` で「ベース」を確認してください。

```
【ベース】
統合版: 作業前提条件_Worker.md v2.6
```

---

## 🎉 まとめ

### 基本的な使い方

1. **超簡単な作業**: `00_QUICK_REFERENCE.md` のみ
2. **通常の作業**: `00_INDEX.md` を読めばOK（自動判定）
3. **複雑な作業**: `00_INDEX.md` を読めばOK（複数モジュール自動読み込み）

### 最大のメリット

- **トークン使用量が77-99%削減**
- **プロプランでも安心**
- **ユーザーは何も覚えなくていい**（INDEXを読むだけ）

---

**分割版を活用して、効率的にClaude Codeを使いましょう！**
