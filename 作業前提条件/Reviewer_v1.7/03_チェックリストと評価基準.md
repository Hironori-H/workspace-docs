# チェックリストと評価基準 - Reviewer用

## 📌 このモジュールについて

**用途**: レビュー観点別の詳細なチェックリストと評価基準
**必読条件**: 具体的なレビュー項目を確認したい時
**関連モジュール**: 02_レビュープロセスとワークフロー.md（レビュープロセス）、01_基本ルールとレビュー原則.md（評価の観点）

---

## レビュー観点別のチェックリスト

### コードレビュー

#### 機能性
- [ ] 要求された機能が全て実装されているか
- [ ] 仕様通りに動作するか
- [ ] エッジケースが考慮されているか
- [ ] 入力値の検証が適切か
- [ ] 出力結果が正しいか

#### コード品質
- [ ] コードが読みやすいか
- [ ] 命名規則が適切か（変数名、関数名）
- [ ] 関数・メソッドが適切な大きさか（長すぎない）
- [ ] 重複コードがないか（DRY原則）
- [ ] コメントが適切に記載されているか

#### エラーハンドリング
- [ ] try-exceptが適切に実装されているか
- [ ] エラーメッセージが適切か
- [ ] エラーログが記録されているか
- [ ] リトライ機構が実装されているか（必要な場合）
- [ ] タイムアウト処理があるか

#### セキュリティ
- [ ] SQLインジェクション対策がされているか
- [ ] XSS対策がされているか
- [ ] 機密情報がハードコードされていないか
- [ ] ファイルパスのトラバーサル対策があるか
- [ ] 入力値の検証・サニタイズがされているか

#### パフォーマンス
- [ ] 不要なループがないか
- [ ] データベースクエリが最適化されているか
- [ ] ファイルI/Oが効率的か
- [ ] メモリリークの可能性がないか
- [ ] 並列処理の活用が検討されているか

#### 保守性
- [ ] ドキュメントが整備されているか
- [ ] 将来的な変更・拡張が容易か
- [ ] モジュール化されているか
- [ ] テストコードがあるか（必要な場合）
- [ ] 依存関係が明確か

---

### ドキュメントレビュー

#### 内容の正確性
- [ ] 記載内容が正確か（誤情報がないか）
- [ ] 最新の状態が反映されているか
- [ ] コードと矛盾していないか
- [ ] 技術的に正しいか
- [ ] バージョン情報が記載されているか

#### 完全性
- [ ] 必要な情報が全て記載されているか
- [ ] 前提条件が明記されているか
- [ ] 使用方法が説明されているか
- [ ] エラー対処法が記載されているか
- [ ] 設定項目が説明されているか

#### 明瞭性
- [ ] 初心者でも理解できるか
- [ ] 曖昧な表現がないか
- [ ] 専門用語が説明されているか
- [ ] 例やサンプルがあるか
- [ ] 図表が活用されているか

#### 構造
- [ ] 論理的な構成になっているか
- [ ] 目次があるか（長いドキュメントの場合）
- [ ] セクションが適切に分割されているか
- [ ] フォーマットが統一されているか
- [ ] リンクが正しいか

---

### スクリプト・バッチファイルレビュー

#### 実行可能性
- [ ] 実際に実行できるか
- [ ] パスが正しいか
- [ ] 依存ファイルが存在するか
- [ ] 実行権限が適切か
- [ ] 環境変数が設定されているか

#### 冪等性
- [ ] 何度実行しても同じ結果になるか
- [ ] 実行前の状態に依存していないか
- [ ] クリーンアップ処理があるか
- [ ] ロールバックが可能か

#### ログ・エラー処理
- [ ] 実行ログが記録されるか
- [ ] エラー発生時のログが適切か
- [ ] 異常終了時の処理があるか
- [ ] リトライ機構があるか（必要な場合）

---

## 評価の観点

### 機能性

**評価基準**:
- 要求された機能が実装されているか
- 仕様通りに動作するか
- エッジケースが考慮されているか

**チェックポイント**:
- [ ] 仕様書と照合し、全ての要件が満たされているか確認
- [ ] 実際に実行して動作を確認（可能な場合）
- [ ] 境界値・異常値でのテストケースを確認

---

### 品質

**評価基準**:
- コードが読みやすいか
- 適切にコメントされているか
- エラーハンドリングが実装されているか
- テストが含まれているか（必要な場合）

**チェックポイント**:
- [ ] 変数名・関数名が分かりやすいか
- [ ] コメントが適切に記載されているか
- [ ] try-except等のエラーハンドリングがあるか
- [ ] ユニットテスト・統合テストがあるか（必要な場合）

---

### 保守性

**評価基準**:
- 変更・拡張が容易か
- ドキュメントが整備されているか
- 命名規則が統一されているか

**チェックポイント**:
- [ ] 関数・クラスが適切に分割されているか
- [ ] README等のドキュメントがあるか
- [ ] コーディングスタイルが統一されているか
- [ ] 依存関係が明確か

---

### セキュリティ

**評価基準**:
- 脆弱性がないか（SQLインジェクション、XSS等）
- 機密情報が漏洩していないか
- 入力値の検証が適切か

**チェックポイント**:
- [ ] SQLインジェクション対策がされているか
- [ ] XSS対策がされているか
- [ ] パスワード・APIキー等がハードコードされていないか
- [ ] 入力値の検証・サニタイズがされているか

---

### パフォーマンス

**評価基準**:
- 不要な処理がないか
- リソースの使用が適切か
- ボトルネックがないか

**チェックポイント**:
- [ ] 不要なループや処理がないか
- [ ] データベースクエリが最適化されているか
- [ ] ファイルI/Oが効率的か
- [ ] メモリ・CPU使用量が適切か

---

### 一貫性

**評価基準**:
- プロジェクトの他の部分と一貫性があるか
- 既存のコーディングスタイルに従っているか
- 作業前提条件に沿っているか

**チェックポイント**:
- [ ] プロジェクトの他の部分と同じスタイルか
- [ ] 既存のアーキテクチャパターンに従っているか
- [ ] 作業前提条件_Worker.mdに沿っているか
- [ ] 命名規則が統一されているか

---

## フィードバックの分類

### Critical（重大）

**定義**: 致命的な問題。修正必須。

**該当する問題**:
- セキュリティ上の脆弱性
- 機能が動作しない
- データ損失のリスク
- 法的・コンプライアンス違反

**対応**:
- 必ず修正が必要
- 修正後の再レビュー必須
- 現状では使用不可

**フィードバック例**:
```markdown
#### 1. セキュリティ: SQLインジェクションの脆弱性
- **ファイル**: script.py
- **行番号**: 45行目
- **問題**: ユーザー入力を直接SQL文に連結している
- **リスク**: SQLインジェクション攻撃のリスク
- **修正案**: プレースホルダーを使用したパラメータ化クエリに変更

```python
# 現状（危険）
query = f"SELECT * FROM users WHERE id = {user_id}"

# 修正案
query = "SELECT * FROM users WHERE id = ?"
cursor.execute(query, (user_id,))
```
```

---

### Major（重要）

**定義**: 重要な問題。修正推奨。

**該当する問題**:
- パフォーマンス問題
- 保守性の大幅な低下
- 重要な仕様の未実装
- エラーハンドリングの欠如

**対応**:
- 修正を強く推奨
- 修正後の再レビュー推奨
- 修正しないと将来問題になる可能性

**フィードバック例**:
```markdown
#### 2. エラーハンドリング: 例外処理の欠如
- **ファイル**: script.py
- **行番号**: 78-85行目
- **問題**: ファイル操作でtry-exceptがない
- **リスク**: ファイルが存在しない場合にクラッシュ
- **修正案**: try-exceptブロックで囲む

```python
# 現状
with open(file_path, 'r') as f:
    data = f.read()

# 修正案
try:
    with open(file_path, 'r') as f:
        data = f.read()
except FileNotFoundError:
    logger.error(f"File not found: {file_path}")
    return None
```
```

---

### Minor（軽微）

**定義**: 軽微な問題。修正推奨だが必須ではない。

**該当する問題**:
- コーディングスタイルの不統一
- コメントの不足
- 命名規則の違反
- 軽微なリファクタリングの提案

**対応**:
- 修正推奨
- 再レビュー不要
- 時間があれば修正

**フィードバック例**:
```markdown
#### 3. コーディングスタイル: 変数名の不統一
- **ファイル**: script.py
- **行番号**: 全体
- **問題**: snake_caseとcamelCaseが混在
- **修正案**: PEP 8に従いsnake_caseに統一

```python
# 現状
userName = "Alice"
user_age = 25

# 修正案
user_name = "Alice"
user_age = 25
```
```

---

### Suggestion（提案）

**定義**: 改善提案。実装は任意。

**該当する問題**:
- より良い実装方法の提案
- 将来的な改善案
- ベストプラクティスの紹介

**対応**:
- 実装は任意
- 再レビュー不要
- 参考情報として活用

**フィードバック例**:
```markdown
#### 4. 改善提案: ロギングの追加
- **ファイル**: script.py
- **提案内容**: 重要な処理にログ出力を追加すると、デバッグが容易になります
- **実装例**: loggingモジュールを使用

```python
import logging

logger = logging.getLogger(__name__)

def process_data(data):
    logger.info(f"Processing {len(data)} items")
    # 処理
    logger.info("Processing completed")
```
```

---

## トラブルシューティング

### レビューで困った場合

#### 判断に迷う場合

**対処法**:
1. **作業前提条件_Worker.mdを確認**
   - プロジェクトの基準を確認
   - 既定のルールを確認

2. **プロジェクトの既存コードと比較**
   - 同様の実装例を探す
   - プロジェクトのパターンを理解

3. **業界標準のベストプラクティスを参照**
   - PEP 8（Python）
   - Google Style Guide
   - OWASP（セキュリティ）

4. **ユーザーに判断基準を確認**
   - AskUserQuestion ツールを使用
   - 「この場合、○○と△△のどちらが適切でしょうか？」

---

#### 技術的に不明な場合

**対処法**:
1. **ドキュメント・コメントを確認**
   - README.mdを確認
   - コード内のコメントを確認
   - 仕様書を確認

2. **関連ファイルを確認**
   - import文を追って依存ファイルを確認
   - 同じ機能の過去バージョンを確認

3. **外部ドキュメントを参照**
   - WebFetchツールで公式ドキュメントを確認
   - ライブラリのAPIリファレンスを確認

4. **ユーザーに技術的な背景を確認**
   - AskUserQuestion ツールを使用
   - 「この処理の技術的な背景を教えていただけますか？」

---

#### 矛盾する要求がある場合

**対処法**:
1. **ユーザーに優先順位を確認**
   - AskUserQuestion ツールを使用
   - 「○○と△△が矛盾しますが、どちらを優先すべきでしょうか？」

2. **トレードオフを明示**
   - 「パフォーマンスを優先すると、可読性が低下します」
   - 「セキュリティを強化すると、実装が複雑になります」

3. **複数の選択肢を提示**
   - 「Aアプローチ: パフォーマンス重視」
   - 「Bアプローチ: 可読性重視」
   - 「Cアプローチ: バランス型」

---

#### ファイルが見つからない場合

**対処法**:
1. **Globツールで検索**
   - `**/*.py` で全Pythonファイルを検索
   - `**/*README*` で全READMEファイルを検索

2. **Grepツールで参照を検索**
   - ファイル名で検索
   - import文で検索

3. **ユーザーに確認**
   - AskUserQuestion ツールを使用
   - 「○○ファイルの場所を教えていただけますか？」

---

#### レビュー基準が不明瞭な場合

**対処法**:
1. **作業前提条件_Worker.mdを確認**
   - プロジェクトの標準ルールを確認

2. **過去のレビュー結果を確認**
   - 過去のレビュー結果ファイルを探す
   - 同様の問題の評価を確認

3. **ユーザーに基準を確認**
   - AskUserQuestion ツールを使用
   - 「この場合のレビュー基準を教えていただけますか？」

---

#### 時間が限られている場合

**優先順位**:
1. **Critical（重大）**: 必ず確認・指摘
2. **Major（重要）**: 確認・指摘を推奨
3. **Minor（軽微）**: 時間があれば確認
4. **Suggestion（提案）**: 余裕があれば提案

**効率的なレビュー**:
- Grepツールでパターン検索（セキュリティ脆弱性等）
- 重要なファイルから優先的にレビュー
- チェックリストを活用

---

## レビュー結果の活用

### 記録の保管

**レビュー結果の保存場所**:
- 日付フォルダ内: `YYYYMMDD/レビュー結果_YYYYMMDD_対象名.md`
- 重要なレビューはDOCS/に保管

**ファイル名の例**:
- `20251113/レビュー結果_20251113_script.md`
- `20251113/レビュー結果_20251113_全体.md`

---

### 傾向分析

定期的に以下を確認：

**頻繁に指摘される問題点**:
- 同じ種類の問題が繰り返されていないか
- プロジェクト全体の弱点を把握

**改善が見られる領域**:
- 過去の指摘が改善されているか
- Workerの成長を確認

**継続的な課題**:
- 何度指摘しても改善されない問題
- 根本的な原因を探る

**ベストプラクティスの共有**:
- 良いコード・実装例を記録
- 他のWorkerに共有

---

**最終更新日**: 2025年11月14日
**バージョン**: 1.2
