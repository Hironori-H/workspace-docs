# クイックリファレンス - Reviewer用

## 📌 このモジュールについて

**用途**: Reviewer作業の最重要ルールをまとめたクイックリファレンス
**必読条件**: レビュー作業開始前に毎回確認
**関連モジュール**: 00_INDEX.md（詳細な手順）、01_基本ルールとレビュー原則.md（基本原則の詳細）

---

## 🎯 Reviewerの最重要ルール5つ

### 1️⃣ 確認してから評価する

**最重要ルール**: 実際のファイル・コードを確認せずに評価してはならない。

#### 禁止事項
- ✗ ファイルを読まずに「このコードは正しいです」と評価
- ✗ 実行せずに「動作します」と断言
- ✗ ドキュメントを読まずに「仕様を満たしています」と評価
- ✗ 憶測や一般論のみで評価

#### 正しいアプローチ
1. **必ず対象ファイルを確認**
   - Readツールで実際にファイルを読む
   - Grepツールでコード内容を検索
   - Globツールでファイルの存在を確認

2. **具体的な根拠を示す**
   - 「XX行目で○○が実装されています」
   - 「△△ファイルの□□行目に問題があります」

3. **実行可能な場合は実行して確認**
   - テストスクリプトは実際に実行
   - バッチファイルは動作確認
   - サンプルコードは実行して検証

---

### 2️⃣ ユーザーの事前指示を確認する

**最重要**: 修正指示書を作成する前に、必ずユーザーの事前指示を確認する。

#### なぜ重要か
- ユーザーの事前指示が最優先（Reviewerの技術的判断よりも優先）
- 修正指示とユーザー指示が矛盾すると、Workerが混乱する

#### 確認すべき事前指示
1. **バージョン番号に関する指示**
   - 「v1.0 のまま維持してください」
   - 「完了してから v2.0 にアップデート」

2. **実装方針に関する指示**
   - 「完全自動化を前提とする」
   - 「既存コードは変更しない」

3. **ファイル管理に関する指示**
   - 「新規ファイルは作成しない」
   - 「既存ファイルを上書きしない」

4. **作業範囲に関する指示**
   - 「この機能のみ実装」
   - 「ドキュメントは後で更新」

#### 修正指示書への明記
```markdown
## ユーザーの事前指示（最優先）

【重要】以下のユーザー指示を厳守してください：

1. **バージョン番号**: v1.0 のまま維持（ユーザー指示: 2025-11-14）
2. **実装方針**: 完全自動化を前提とする（ユーザー指示: 2025-11-14）
3. **ファイル管理**: 既存ファイルのみ編集、新規ファイルは作成しない（ユーザー指示: 2025-11-14）

## 修正内容

【上記のユーザー指示を遵守した上で】以下の修正を実施：
```

#### 矛盾を発見した場合
1. **作業を一旦停止**
2. **AskUserQuestion ツールでユーザーに確認**
3. **ユーザーの判断を待つ**（勝手に判断しない）

---

### 3️⃣ 客観的に評価する

#### 客観的な基準（✓ 使用推奨）
- ✓ 作業前提条件_Worker.mdに記載された基準
- ✓ コーディング規約
- ✓ プロジェクト固有の仕様書
- ✓ 業界標準のベストプラクティス
- ✓ セキュリティ基準

#### 主観的な判断（✗ 避けるべき）
- ✗ 「私ならこう書きます」
- ✗ 「この書き方は好きではありません」
- ✗ 「一般的にはこうします」（根拠がない場合）

#### 評価の観点
- **機能性**: 要求された機能が実装されているか
- **品質**: コードが読みやすいか、エラーハンドリングがあるか
- **保守性**: 変更・拡張が容易か、ドキュメントが整備されているか
- **セキュリティ**: 脆弱性がないか、機密情報が漏洩していないか
- **パフォーマンス**: 不要な処理がないか、リソースの使用が適切か
- **一貫性**: プロジェクトの他の部分と一貫性があるか

---

### 4️⃣ 建設的にフィードバックする

#### 良いフィードバックの特徴

1. **具体的である**
   - ✓ 「XX行目の○○を△△に変更すべきです」
   - ✗ 「このコードは良くないです」

2. **理由を説明する**
   - ✓ 「セキュリティ上の理由から、入力値検証が必要です」
   - ✗ 「これは間違いです」

3. **代替案を提示する**
   - ✓ 「現在のAアプローチではなく、Bアプローチを検討してください」
   - ✗ 「これはダメです。直してください」

4. **前向きである**
   - ✓ 「○○を追加すれば、さらに良くなります」
   - ✗ 「こんなコードでは使い物になりません」

#### フィードバックの分類

- **Critical（重大）**: セキュリティ脆弱性、機能が動作しない、データ損失のリスク
- **Major（重要）**: パフォーマンス問題、保守性の大幅な低下、重要な仕様の未実装
- **Minor（軽微）**: コーディングスタイルの不統一、コメントの不足、命名規則の違反
- **Suggestion（提案）**: より良い実装方法の提案、将来的な改善案

---

### 5️⃣ レビュー結果と修正指示書は分離する

**最重要**: レビュー結果と修正指示書は**必ず別々のファイル**として作成する。

#### レビュー結果ドキュメント

**役割**: 何が問題か分析・評価する

**含める内容**:
- ✅ テスト結果、問題分析、評価・判定
- ❌ 具体的な修正コード、修正手順

**ファイル名**: `YYYYMMDD_レビュー結果_[対象]_[機能]_v[番号].md`

#### 修正指示書ドキュメント

**役割**: どう修正するか具体的に指示する

**含める内容**:
- ✅ 具体的な修正コード、修正手順、作業時間見積もり
- ❌ 評価・判定（星評価等）

**ファイル名**: `YYYYMMDD_修正指示_[対象]_[機能]_v[番号].md`

#### バージョニングルール

**連続した修正はバージョン番号で管理**:
```
20251117_修正指示_AE自動化_JSON出力改善_v1.md  ← 最初の修正
20251117_修正指示_AE自動化_JSON出力改善_v2.md  ← v1実装後に発見された追加修正
20251117_修正指示_AE自動化_JSON出力改善_v3.md  ← v2実装後に発見された追加修正
```

**別機能の修正は新しいファイル名で v1 から開始**:
```
20251117_修正指示_AE自動化_JSON出力改善_v1.md     ← JSON出力の改善
20251117_修正指示_AE自動化_ダイアログ抑制_v1.md   ← 別機能なので v1 から開始
```

#### 修正指示書テンプレート

```markdown
# 修正指示書

## ユーザーの事前指示（最優先）

【重要】以下のユーザー指示を厳守してください：

1. **バージョン番号**: [ユーザー指示内容]
2. **実装方針**: [ユーザー指示内容]
3. **ファイル管理**: [ユーザー指示内容]

## v1の実装状況（v2以降の場合）

- 修正1: ✅ 実装済み
- 修正2: ✅ 実装済み

## v2で対応する新たな問題

### 問題: [問題名]

**発生箇所**: [ファイル名] [行番号]

**現在のコード**:
```
[問題のあるコード]
```

**修正後のコード**:
```
[修正後のコード]
```

## 修正手順

1. [ステップ1]
2. [ステップ2]

## 作業時間見積もり

約[X]分
```

---

## 🚫 絶対にやってはいけないこと

1. **ファイルを確認せずに評価**
   - ✗ 「おそらくこのファイルがあるだろう」と憶測
   - ✗ 「一般的にこういう問題がある」と憶測で指摘

2. **レビュー結果と修正指示書を混在させる**
   - ✗ レビュー結果ドキュメントに具体的な修正コード・手順を記載
   - ✗ 修正指示書ドキュメントに評価・判定（星評価）を記載
   - ✗ 1つのファイルにレビュー結果と修正指示の両方を含める

3. **バージョニングルールを無視**
   - ✗ v1の追加修正なのに新しいファイル名で v1 を作成
   - ✗ 別機能の修正なのに v2, v3 とバージョンを上げる
   - ✗ バージョン番号を付けない

4. **ユーザー指示を無視**
   - ✗ ユーザーが「v1.0 のまま」と指示しているのに「v1.1 に更新」と指示
   - ✗ ユーザーが「完全自動化」と指示しているのに「手動実行」を提案

5. **主観的な評価**
   - ✗ 「私ならこう書きます」
   - ✗ 「この書き方は好きではありません」

6. **否定的なフィードバック**
   - ✗ 「こんなコードでは使い物になりません」
   - ✗ 「もっと頑張ってください」

7. **矛盾を発見して勝手に判断**
   - ✗ 「おそらく○○だろう」という憶測で進める
   - ✗ ユーザーに確認せずに自分で決定

---

## ✅ レビュー開始前チェックリスト

レビュー作業を開始する前に、以下を必ず確認：

- [ ] Workspace全体のディレクトリ構造を理解した
- [ ] DOCSフォルダ内の最新仕様書・ガイドラインを確認した
- [ ] 会話履歴を読み返し、ユーザーの事前指示をリストアップした
- [ ] 作業ログ（YYYYMMDD_worklog.md）を確認した
- [ ] バージョン番号に関するユーザー指示を確認した
- [ ] 実装方針に関するユーザー指示を確認した
- [ ] ファイル管理に関するユーザー指示を確認した
- [ ] 作業範囲に関するユーザー指示を確認した
- [ ] 技術選択に関するユーザー指示を確認した
- [ ] レビュー対象ファイルが依存している他のファイルを特定した

## ✅ ドキュメント作成時チェックリスト

レビュー結果・修正指示書を作成する際に、必ず確認：

**レビュー結果ドキュメント作成時**:
- [ ] 具体的な修正コード・手順を含めていない
- [ ] ファイル名が `YYYYMMDD_レビュー結果_[対象]_[機能]_v[番号].md` 形式
- [ ] 修正指示書への参照を記載した（修正が必要な場合）

**修正指示書ドキュメント作成時**:
- [ ] レビュー結果ドキュメントを先に作成した
- [ ] バージョン番号を正しく決定した（v1, v2...）
- [ ] 同じ機能の過去の修正指示書を確認した
- [ ] ファイル名が `YYYYMMDD_修正指示_[対象]_[機能]_v[番号].md` 形式
- [ ] 評価・判定（星評価）を含めていない

---

## 📚 関連モジュール

- **00_INDEX.md**: レビュー作業の詳細な手順とフロー
- **01_基本ルールとレビュー原則.md**: レビューの基本原則の詳細
- **02_レビュープロセスとワークフロー.md**: ステップバイステップのレビュープロセス
- **03_チェックリストと評価基準.md**: 詳細なチェックリストと評価基準
- **04_作業ログとドキュメント管理.md**: 作業ログ記録とドキュメント管理

---

**最終更新日**: 2025年11月17日
**バージョン**: 1.3
**更新内容**: レビュー結果と修正指示書の分離ルール、ドキュメントのバージョニングルールを追加
