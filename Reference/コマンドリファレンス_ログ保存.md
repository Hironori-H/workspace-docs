# コマンドリファレンス: ログ保存

macOSターミナルでの作業ログを手軽に保存するためのコマンド集

---

## 基本構造

```
WorkSpace/
├── YYYYMMDD/
│   └── terminal_log/
│       └── HHMM_コマンド名.txt
└── terminal_log/  ← 一時保存先（後で自動整理）
```

---

## 方法1: 今日の日付フォルダに直接保存

### bash/zsh
```bash
コマンド > /Users/hiraihironori/Desktop/WorkSpace/20251119/terminal_log/1530_npm_start.txt 2>&1
```

### 具体例
```bash
npm start > /Users/hiraihironori/Desktop/WorkSpace/20251119/terminal_log/1530_npm_start.txt 2>&1
python script.py > /Users/hiraihironori/Desktop/WorkSpace/20251119/terminal_log/1545_python_test.txt 2>&1
ls -R > /Users/hiraihironori/Desktop/WorkSpace/20251119/terminal_log/1600_ls_list.txt 2>&1
```

**注意**: 日付フォルダ（`20251119`）は毎日変更する必要があります

---

## 方法2: terminal_log に一時保存（推奨）

### bash/zsh
```bash
コマンド > /Users/hiraihironori/Desktop/WorkSpace/terminal_log/20251119_1530_npm_start.txt 2>&1
```

### 具体例
```bash
npm start > /Users/hiraihironori/Desktop/WorkSpace/terminal_log/20251119_1530_npm_start.txt 2>&1
python script.py > /Users/hiraihironori/Desktop/WorkSpace/terminal_log/20251119_1545_python_test.txt 2>&1
```

**後で自動整理**:
```bash
bash /Users/hiraihironori/Desktop/WorkSpace/batch_file/organize_terminal_logs.sh
```

**メリット**: 日付フォルダを意識せずに保存可能

---

## 方法3: 画面表示しながら保存（tee コマンド）

### bash/zsh
```bash
コマンド | tee /Users/hiraihironori/Desktop/WorkSpace/terminal_log/20251119_1530_コマンド名.txt
```

### 具体例
```bash
npm start | tee /Users/hiraihironori/Desktop/WorkSpace/terminal_log/20251119_1530_npm_start.txt
python script.py | tee /Users/hiraihironori/Desktop/WorkSpace/terminal_log/20251119_1545_python_test.txt
```

### エラー出力も含める場合
```bash
npm start 2>&1 | tee /Users/hiraihironori/Desktop/WorkSpace/terminal_log/20251119_1530_npm_start.txt
```

**メリット**: 画面にも出力を表示しながらログ保存

---

## 方法4: クリップボードから保存

### 手順
1. ターミナルの出力を選択してコピー（Cmd+C）

2. コマンドで保存
```bash
pbpaste > /Users/hiraihironori/Desktop/WorkSpace/terminal_log/20251119_1530_clipboard.txt
```

**短縮版**（変数で日時を自動取得）:
```bash
datetime=$(date +"%Y%m%d_%H%M")
pbpaste > /Users/hiraihironori/Desktop/WorkSpace/terminal_log/${datetime}_clipboard.txt
```

---

## 方法5: セッション全体を記録（script コマンド）

### セッション開始時
```bash
datetime=$(date +"%Y%m%d_%H%M")
script /Users/hiraihironori/Desktop/WorkSpace/terminal_log/${datetime}_session.txt
```

### セッション終了時
```bash
exit
```

**メリット**: すべての入出力が自動記録される

**注意**: macOSの`script`コマンドは`script <ファイル名>`の形式で使用します

---

## 日付・時刻の自動取得

### bash/zsh変数を使用
```bash
# 日付のみ（YYYYMMDD）
date_str=$(date +"%Y%m%d")

# 日付+時刻（YYYYMMDD_HHMM）
datetime=$(date +"%Y%m%d_%H%M")

# 使用例
npm start > /Users/hiraihironori/Desktop/WorkSpace/terminal_log/${datetime}_npm_start.txt 2>&1
```

### 今日の日付フォルダに保存（自動）
```bash
date_str=$(date +"%Y%m%d")
time_str=$(date +"%H%M")
npm start > /Users/hiraihironori/Desktop/WorkSpace/$date_str/terminal_log/${time_str}_npm_start.txt 2>&1
```

### ホームディレクトリを使ったパス（推奨）
```bash
# ~（チルダ）を使用すると短く書ける
datetime=$(date +"%Y%m%d_%H%M")
npm start > ~/Desktop/WorkSpace/terminal_log/${datetime}_npm_start.txt 2>&1
```

---

## よく使うコマンドのテンプレート

### npm start のログ保存
```bash
datetime=$(date +"%Y%m%d_%H%M")
npm start 2>&1 | tee ~/Desktop/WorkSpace/terminal_log/${datetime}_npm_start.txt
```

### Python スクリプトのログ保存
```bash
datetime=$(date +"%Y%m%d_%H%M")
python script.py 2>&1 | tee ~/Desktop/WorkSpace/terminal_log/${datetime}_python_script.txt
```

### ディレクトリ一覧の保存
```bash
datetime=$(date +"%Y%m%d_%H%M")
ls -lR > ~/Desktop/WorkSpace/terminal_log/${datetime}_ls_list.txt
```

### git コマンドのログ保存
```bash
datetime=$(date +"%Y%m%d_%H%M")
git status > ~/Desktop/WorkSpace/terminal_log/${datetime}_git_status.txt
git log --oneline -20 > ~/Desktop/WorkSpace/terminal_log/${datetime}_git_log.txt
```

---

## エイリアス設定（bash/zsh）

### .zshrc または .bashrc に追加
```bash
# シェルプロファイルを開く
nano ~/.zshrc  # zshの場合
nano ~/.bashrc # bashの場合

# 以下を追加
function save-log() {
    local description=$1
    local datetime=$(date +"%Y%m%d_%H%M")
    local log_path=~/Desktop/WorkSpace/terminal_log/${datetime}_${description}.txt
    shift
    "$@" 2>&1 | tee "$log_path"
}

# 使用例
# save-log npm_start npm start
```

### エイリアス適用
```bash
source ~/.zshrc  # zshの場合
source ~/.bashrc # bashの場合
```

---

## PowerShell Core での利用（macOS）

macOSでもPowerShell Coreがインストールされていれば、PowerShellコマンドを使用できます。

### インストール
```bash
brew install powershell
```

### PowerShell起動
```bash
pwsh
```

### PowerShellでのログ保存
```powershell
$datetime = Get-Date -Format "yyyyMMdd_HHmm"
npm start | Tee-Object -FilePath "~/Desktop/WorkSpace/terminal_log/${datetime}_npm_start.txt"
```

---

## 運用フロー

### 日常作業
1. 重要なコマンド実行時に方法2または方法3を使用
2. クリップボードから保存したい場合は方法4を使用

### 1日の終わりに
```bash
# terminal_log を自動整理（日付フォルダに移動）
bash ~/Desktop/WorkSpace/batch_file/organize_terminal_logs.sh
```

---

## 注意事項

- `2>&1` : 標準出力とエラー出力の両方を保存
- ファイル名形式: `YYYYMMDD_HHMM_コマンド名.txt`（terminal_log 用）
- ファイル名形式: `HHMM_コマンド名.txt`（日付フォルダ内）
- スペースは `_`（アンダースコア）に置き換え
- 自動整理スクリプトは今日以外のログを日付フォルダに移動
- macOSではパスに`~`（チルダ）を使うと短く書けます

---

**最終更新**: 2025年11月22日
**関連スクリプト**:
- `batch_file/organize_terminal_logs.sh` - terminal_log 自動整理
- `batch_file/organize_screenshots.sh` - screenshots 自動整理
